lvgl:
  pages:
    - id: page_graphs
      on_load:
        - lambda: |-
            id(graph_page_active) = true;
            id(last_interaction_ms) = millis();
            id(last_auto_scroll_ms) = id(last_interaction_ms);
        - script.execute: graph_render
      on_unload:
        - lambda: |-
            id(graph_page_active) = false;
            id(graph_touch_valid) = false;
      widgets:
        - obj:
            id: graph_box
            align: TOP_MID
            y: 50
            width: 440
            height: 220
            bg_color: 0x0D141C
            border_color: 0x2A3A4A
            border_width: 2
            radius: 8
            pad_all: 6
            widgets:
              - line:
                  id: graph_line
                  align: TOP_LEFT
                  x: 10
                  y: 10
                  points:
                    - x: 0
                      y: !lambda 'return id(graph_points)[0];'
                    - x: 7
                      y: !lambda 'return id(graph_points)[1];'
                    - x: 14
                      y: !lambda 'return id(graph_points)[2];'
                    - x: 21
                      y: !lambda 'return id(graph_points)[3];'
                    - x: 28
                      y: !lambda 'return id(graph_points)[4];'
                    - x: 35
                      y: !lambda 'return id(graph_points)[5];'
                    - x: 42
                      y: !lambda 'return id(graph_points)[6];'
                    - x: 49
                      y: !lambda 'return id(graph_points)[7];'
                    - x: 56
                      y: !lambda 'return id(graph_points)[8];'
                    - x: 63
                      y: !lambda 'return id(graph_points)[9];'
                    - x: 70
                      y: !lambda 'return id(graph_points)[10];'
                    - x: 77
                      y: !lambda 'return id(graph_points)[11];'
                    - x: 84
                      y: !lambda 'return id(graph_points)[12];'
                    - x: 91
                      y: !lambda 'return id(graph_points)[13];'
                    - x: 98
                      y: !lambda 'return id(graph_points)[14];'
                    - x: 105
                      y: !lambda 'return id(graph_points)[15];'
                    - x: 112
                      y: !lambda 'return id(graph_points)[16];'
                    - x: 119
                      y: !lambda 'return id(graph_points)[17];'
                    - x: 126
                      y: !lambda 'return id(graph_points)[18];'
                    - x: 133
                      y: !lambda 'return id(graph_points)[19];'
                    - x: 140
                      y: !lambda 'return id(graph_points)[20];'
                    - x: 147
                      y: !lambda 'return id(graph_points)[21];'
                    - x: 154
                      y: !lambda 'return id(graph_points)[22];'
                    - x: 161
                      y: !lambda 'return id(graph_points)[23];'
                    - x: 168
                      y: !lambda 'return id(graph_points)[24];'
                    - x: 175
                      y: !lambda 'return id(graph_points)[25];'
                    - x: 182
                      y: !lambda 'return id(graph_points)[26];'
                    - x: 189
                      y: !lambda 'return id(graph_points)[27];'
                    - x: 196
                      y: !lambda 'return id(graph_points)[28];'
                    - x: 203
                      y: !lambda 'return id(graph_points)[29];'
                    - x: 210
                      y: !lambda 'return id(graph_points)[30];'
                    - x: 217
                      y: !lambda 'return id(graph_points)[31];'
                    - x: 224
                      y: !lambda 'return id(graph_points)[32];'
                    - x: 231
                      y: !lambda 'return id(graph_points)[33];'
                    - x: 238
                      y: !lambda 'return id(graph_points)[34];'
                    - x: 245
                      y: !lambda 'return id(graph_points)[35];'
                    - x: 252
                      y: !lambda 'return id(graph_points)[36];'
                    - x: 259
                      y: !lambda 'return id(graph_points)[37];'
                    - x: 266
                      y: !lambda 'return id(graph_points)[38];'
                    - x: 273
                      y: !lambda 'return id(graph_points)[39];'
                    - x: 280
                      y: !lambda 'return id(graph_points)[40];'
                    - x: 287
                      y: !lambda 'return id(graph_points)[41];'
                    - x: 294
                      y: !lambda 'return id(graph_points)[42];'
                    - x: 301
                      y: !lambda 'return id(graph_points)[43];'
                    - x: 308
                      y: !lambda 'return id(graph_points)[44];'
                    - x: 315
                      y: !lambda 'return id(graph_points)[45];'
                    - x: 322
                      y: !lambda 'return id(graph_points)[46];'
                    - x: 329
                      y: !lambda 'return id(graph_points)[47];'
                    - x: 336
                      y: !lambda 'return id(graph_points)[48];'
                    - x: 343
                      y: !lambda 'return id(graph_points)[49];'
                    - x: 350
                      y: !lambda 'return id(graph_points)[50];'
                    - x: 357
                      y: !lambda 'return id(graph_points)[51];'
                    - x: 364
                      y: !lambda 'return id(graph_points)[52];'
                    - x: 371
                      y: !lambda 'return id(graph_points)[53];'
                    - x: 378
                      y: !lambda 'return id(graph_points)[54];'
                    - x: 385
                      y: !lambda 'return id(graph_points)[55];'
                    - x: 392
                      y: !lambda 'return id(graph_points)[56];'
                    - x: 399
                      y: !lambda 'return id(graph_points)[57];'
                    - x: 406
                      y: !lambda 'return id(graph_points)[58];'
                    - x: 413
                      y: !lambda 'return id(graph_points)[59];'
                  line_width: 2
                  line_color: 0x66CCFF
        - label:
            id: graph_title_label
            text: "Graph"
            align: TOP_MID
            y: 39
            text_font: montserrat_28
            text_color: 0xFFFFFF

        - label:
            id: graph_current_label
            text: "Now: --"
            align: TOP_LEFT
            x: 20
            y: 280
            text_font: montserrat_20
            text_color: 0xFFFFFF

        - label:
            id: graph_min_label
            text: "Min: --"
            align: TOP_MID
            y: 280
            text_font: montserrat_20
            text_color: 0xB0B0B0

        - label:
            id: graph_max_label
            text: "Max: --"
            align: TOP_RIGHT
            x: -20
            y: 280
            text_font: montserrat_20
            text_color: 0xB0B0B0

        - label:
            id: graph_touch_label
            text: "Tap: --"
            align: TOP_MID
            y: 300
            text_font: montserrat_18
            text_color: 0xA0A0A0

        - label:
            text: "Period"
            align: TOP_LEFT
            x: 20
            y: 340
            text_font: montserrat_18
            text_color: 0xB0B0B0

        - button:
            id: graph_period_1h
            text: "1h"
            align: TOP_LEFT
            x: 90
            y: 330
            width: 70
            height: 40
            bg_color: 0x1F2933
            text_color: 0xC0C0C0
            text_font: montserrat_18
            on_release:
              - logger.log: "graph_btn period=1h"
              - lambda: 'id(graph_period_min) = 60;'
              - script.execute: graph_render

        - button:
            id: graph_period_6h
            text: "6h"
            align: TOP_LEFT
            x: 170
            y: 330
            width: 70
            height: 40
            bg_color: 0x1F2933
            text_color: 0xC0C0C0
            text_font: montserrat_18
            on_release:
              - logger.log: "graph_btn period=6h"
              - lambda: 'id(graph_period_min) = 360;'
              - script.execute: graph_render

        - button:
            id: graph_period_24h
            text: "24h"
            align: TOP_LEFT
            x: 250
            y: 330
            width: 80
            height: 40
            bg_color: 0x1F2933
            text_color: 0xC0C0C0
            text_font: montserrat_18
            on_release:
              - logger.log: "graph_btn period=24h"
              - lambda: 'id(graph_period_min) = 1440;'
              - script.execute: graph_render

        - label:
            text: "Step"
            align: TOP_LEFT
            x: 20
            y: 390
            text_font: montserrat_18
            text_color: 0xB0B0B0

        - button:
            id: graph_step_1m
            text: "1m"
            align: TOP_LEFT
            x: 90
            y: 380
            width: 70
            height: 40
            bg_color: 0x1F2933
            text_color: 0xC0C0C0
            text_font: montserrat_18
            on_release:
              - logger.log: "graph_btn step=1m"
              - lambda: 'id(graph_step_min) = 1;'
              - script.execute: graph_render

        - button:
            id: graph_step_5m
            text: "5m"
            align: TOP_LEFT
            x: 170
            y: 380
            width: 70
            height: 40
            bg_color: 0x1F2933
            text_color: 0xC0C0C0
            text_font: montserrat_18
            on_release:
              - logger.log: "graph_btn step=5m"
              - lambda: 'id(graph_step_min) = 5;'
              - script.execute: graph_render

        - button:
            id: graph_step_15m
            text: "15m"
            align: TOP_LEFT
            x: 250
            y: 380
            width: 80
            height: 40
            bg_color: 0x1F2933
            text_color: 0xC0C0C0
            text_font: montserrat_18
            on_release:
              - logger.log: "graph_btn step=15m"
              - lambda: 'id(graph_step_min) = 15;'
              - script.execute: graph_render

#        - button:
#            id: nav_home_graphs
#            text: "Home"
#            align: BOTTOM_MID
#            y: -20
#            text_font: montserrat_20
#            on_press:
#              - lvgl.page.show:
#                  id: page_home


