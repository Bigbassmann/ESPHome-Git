# label: Settings:               align: TOP_MID, y: 32
# label: Idle Timed Scroll:      align: CENTER,  y: 76
# button: Auto Scroll:           align: TOP_MID  y: 106
# label: Idle Delay:             align: TOP_MID  y: 153  
# slider: Idle Delay:            align: TOP_MID  y: 178 Seconds: x:148 y: 178
# label: Display Sleep:          align: TOP_MID  y: 230
# button: Sleep:                 align: TOP_MID  y: 260
# label: Sleep Timeout:          align: TOP_MID  y: 308  
# slider: Sleep Timeout:         align: TOP_MID  y: 332 Seconds: x:148 y: 332
# label: Display Brightness:     align: TOP_MID  y: 370
# slider: Brightness:            align: TOP_MID  y: 400 Dim Icon: x: -148 y: 398 Bright Icon: x: 148 y: 398

lvgl:
  pages:
    - id: page_settings
      widgets:
        - label:
            id: settings_title
            text: "Settings"
            align: TOP_MID
            y: 32
            text_font: montserrat_30
            text_color: 0xFFFFFF

        - label:
            id: idle_scroll_title
            text: "Idle Timed Scroll"
            align: TOP_MID
            y: 76
            text_font: montserrat_22
            text_color: 0xFFFFFF

        - button:
            id: idle_scroll_enable_btn
            align: TOP_MID
            y: 106
            width: 260
            height: 40
            bg_color: 0x374151
            radius: 8
            border_width: 0
            on_press:
              then:
                - lambda: |-
                    id(display_idle_scroll_enabled) = !id(display_idle_scroll_enabled);
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);
            widgets:
              - label:
                  text: "Auto Scroll"
                  align: LEFT_MID
                  x: 12
                  text_font: montserrat_20
                  text_color: 0xFFFFFF
              - label:
                  id: idle_scroll_enable_state
                  text: "OFF"
                  align: RIGHT_MID
                  x: -12
                  text_font: montserrat_20
                  text_color: 0xFCA5A5

        - label:
            id: idle_scroll_timeout_label
            text: "Idle Delay"
            align: TOP_MID
            y: 154
            text_font: montserrat_20
            text_color: 0xFFFFFF

        - slider:
            id: idle_scroll_timeout_slider
            align: TOP_MID
            y: 178
            width: 300
            height: 16
            min_value: 15
            max_value: 300
            bg_color: 0x374151
            knob:
              bg_color: 0xFFFFFF
              border_color: 0x0EA5E9
              border_width: 2
            indicator:
              bg_color: 0x0EA5E9
            on_value:
              then:
                - lambda: 'id(display_idle_scroll_s) = x;'

        - label:
            id: idle_scroll_timeout_value
            text: "30s"
            align: TOP_MID
            x: 148
            y: 178 # 200
            text_font: montserrat_18
            text_color: 0xC0C0C0

        - label:
            id: sleep_title
            text: "Display Sleep"
            align: TOP_MID
            y: 230
            text_font: montserrat_22
            text_color: 0xFFFFFF

        - button:
            id: sleep_enable_btn
            align: TOP_MID
            y: 260
            width: 260
            height: 40
            bg_color: 0x374151
            radius: 8
            border_width: 0
            on_press:
              then:
                - lambda: |-
                    id(display_sleep_enabled) = !id(display_sleep_enabled);
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);
                - if:
                    condition:
                      lambda: 'return !id(display_sleep_enabled) && id(screen_off);'
                    then:
                      - lvgl.resume:
                      - light.turn_on: backlight
                      - lambda: 'id(screen_off) = false;'
            widgets:
              - label:
                  text: "Sleep"
                  align: LEFT_MID
                  x: 12
                  text_font: montserrat_20
                  text_color: 0xFFFFFF
              - label:
                  id: sleep_enable_state
                  text: "ON"
                  align: RIGHT_MID
                  x: -12
                  text_font: montserrat_20
                  text_color: 0xD1FAE5

        - label:
            id: sleep_timeout_label
            text: "Sleep Timeout"
            align: TOP_MID
            y: 308
            text_font: montserrat_20
            text_color: 0xFFFFFF

        - slider:
            id: sleep_timeout_slider
            align: TOP_MID
            y: 332
            width: 300
            height: 16
            min_value: 15
            max_value: 300
            bg_color: 0x374151
            knob:
              bg_color: 0xFFFFFF
              border_color: 0x2563EB
              border_width: 2
            indicator:
              bg_color: 0x2563EB
            on_value:
              then:
                - lambda: 'id(display_sleep_timeout_s) = x;'

        - label:
            id: sleep_timeout_value
            text: "60s"
            align: TOP_MID
            x: 148
            y: 332  # 354
            text_font: montserrat_18
            text_color: 0xC0C0C0

        - label:
            id: brightness_label
            text: "Display Brightness"
            align: TOP_MID
            y: 370  # 376
            text_font: montserrat_22
            text_color: 0xFFFFFF

        - image:
            align: TOP_MID
            x: -148
            y: 398  # 404
            src: icon_dim_24

        - slider:
            id: brightness_slider
            align: TOP_MID
            y: 400  # 406
            width: 240
            height: 18
            min_value: 0
            max_value: 100
            bg_color: 0x374151
            knob:
              bg_color: 0xFFFFFF
              border_color: 0x4F46E5
              border_width: 2
            indicator:
              bg_color: 0x4F46E5
            on_value:
              then:
                - light.control:
                    id: backlight
                    brightness: !lambda |-
                      if (x == 0) return 0.0f;
                      return x / 100.0f;

        - image:
            align: TOP_MID
            x: 148
            y: 398 # 404
            src: icon_bright_24