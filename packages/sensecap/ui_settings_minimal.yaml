lvgl:
  pages:
    - id: page_settings
      widgets:

        - label:
            id: settings_title
            text: "Settings"
            align: TOP_MID
            y: 40
            text_font: montserrat_32
            text_color: 0xFFFFFF

        - label:
            id: brightness_label
            text: "Display Brightness"
            align: CENTER
            y: 62
            text_font: montserrat_24
            text_color: 0xFFFFFF

        - image:
            align: CENTER
            x: -140
            y: 88
            src: icon_dim_24

        - slider:
            id: brightness_slider
            align: CENTER
            y: 92
            width: 200
            height: 20
            min_value: 0
            max_value: 100
            bg_color: 0x374151
            knob:
              bg_color: 0xFFFFFF
              border_color: 0x4F46E5
              border_width: 2
            indicator:
              bg_color: 0x4F46E5
            on_value:
              then:
                - light.control:
                    id: backlight
                    brightness: !lambda |-
                      if (x == 0) return 0.0f;
                      return x / 100.0f;
                - lambda: |-
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);

        - image:
            align: CENTER
            x: 140
            y: 88
            src: icon_bright_24

        - label:
            id: sleep_title
            text: "Display Sleep"
            align: CENTER
            y: 138
            text_font: montserrat_24
            text_color: 0xFFFFFF

        - button:
            id: sleep_enable_btn
            align: CENTER
            y: 170
            width: 220
            height: 42
            bg_color: 0x374151
            radius: 8
            border_width: 0
            on_press:
              then:
                - lambda: |-
                    id(display_sleep_enabled) = !id(display_sleep_enabled);
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);
                - if:
                    condition:
                      lambda: 'return !id(display_sleep_enabled) && id(screen_off);'
                    then:
                      - lvgl.resume:
                      - light.turn_on: backlight
                      - lambda: 'id(screen_off) = false;'
            widgets:
              - label:
                  text: "Sleep"
                  align: LEFT_MID
                  x: 12
                  text_font: montserrat_20
                  text_color: 0xFFFFFF
              - label:
                  id: sleep_enable_state
                  text: "ON"
                  align: RIGHT_MID
                  x: -12
                  text_font: montserrat_20
                  text_color: 0xD1FAE5

        - label:
            id: sleep_timeout_label
            text: "Sleep Timeout"
            align: CENTER
            y: 216
            text_font: montserrat_22
            text_color: 0xFFFFFF

        - slider:
            id: sleep_timeout_slider
            align: CENTER
            y: 240
            width: 280
            height: 18
            min_value: 15
            max_value: 300
            bg_color: 0x374151
            knob:
              bg_color: 0xFFFFFF
              border_color: 0x2563EB
              border_width: 2
            indicator:
              bg_color: 0x2563EB
            on_value:
              then:
                - lambda: |-
                    id(display_sleep_timeout_s) = x;
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);

        - label:
            id: sleep_timeout_value
            text: "60s"
            align: CENTER
            y: 264
            text_font: montserrat_20
            text_color: 0xC0C0C0

        - label:
            id: idle_scroll_title
            text: "Idle Timed Scroll"
            align: CENTER
            y: 300
            text_font: montserrat_22
            text_color: 0xFFFFFF

        - button:
            id: idle_scroll_enable_btn
            align: CENTER
            y: 330
            width: 220
            height: 42
            bg_color: 0x374151
            radius: 8
            border_width: 0
            on_press:
              then:
                - lambda: |-
                    id(display_idle_scroll_enabled) = !id(display_idle_scroll_enabled);
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);
            widgets:
              - label:
                  text: "Auto Scroll"
                  align: LEFT_MID
                  x: 12
                  text_font: montserrat_20
                  text_color: 0xFFFFFF
              - label:
                  id: idle_scroll_enable_state
                  text: "OFF"
                  align: RIGHT_MID
                  x: -12
                  text_font: montserrat_20
                  text_color: 0xFCA5A5

        - label:
            id: idle_scroll_timeout_label
            text: "Idle Delay"
            align: CENTER
            y: 372
            text_font: montserrat_20
            text_color: 0xFFFFFF

        - slider:
            id: idle_scroll_timeout_slider
            align: CENTER
            y: 394
            width: 280
            height: 16
            min_value: 15
            max_value: 300
            bg_color: 0x374151
            knob:
              bg_color: 0xFFFFFF
              border_color: 0x0EA5E9
              border_width: 2
            indicator:
              bg_color: 0x0EA5E9
            on_value:
              then:
                - lambda: |-
                    id(display_idle_scroll_s) = x;
                    id(last_interaction_ms) = millis();
                    id(last_auto_scroll_ms) = id(last_interaction_ms);

        - label:
            id: idle_scroll_timeout_value
            text: "30s"
            align: CENTER
            y: 416
            text_font: montserrat_18
            text_color: 0xC0C0C0